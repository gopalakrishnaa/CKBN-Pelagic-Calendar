<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pelagic Bird Watching Trips - Mangaluru</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flatpickr/4.6.13/flatpickr.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/flatpickr/4.6.13/flatpickr.min.js"></script>
    <style>
        :root {
            --ocean-blue: #1a73e8;
            --light-blue: #e8f0fe;
            --dark-blue: #0d47a1;
            --submit-green: #34a853;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--light-blue);
            color: #333;
            line-height: 1.6;
        }
        
        header {
            background-color: var(--ocean-blue);
            color: white;
            text-align: center;
            padding: 2rem 1rem;
            position: relative;
            overflow: hidden;
        }
        
        header::after {
            content: "";
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 20px;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 100"><path fill="white" d="M0,64L80,58.7C160,53,320,43,480,48C640,53,800,75,960,80C1120,85,1280,75,1360,69.3L1440,64L1440,100L1360,100C1280,100,1120,100,960,100C800,100,640,100,480,100C320,100,160,100,80,100L0,100Z"></path></svg>') no-repeat bottom;
            background-size: 100% 100%;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }
        
        h2 {
            font-size: 2rem;
            color: var(--dark-blue);
            margin: 2rem 0 1rem;
        }
        
        p {
            margin-bottom: 1rem;
        }
        
        .hero-text {
            max-width: 800px;
            margin: 0 auto 1rem;
        }
        
        .calendar-section {
            background-color: white;
            border-radius: 10px;
            padding: 2rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }
        
        .trip-options {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            margin: 2rem 0;
        }
        
        .trip-option {
            background-color: white;
            border-radius: 10px;
            padding: 1.5rem;
            width: 30%;
            min-width: 250px;
            margin: 1rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        
        .trip-option h3 {
            color: var(--ocean-blue);
            margin-bottom: 1rem;
        }
        
        .form-section {
            background-color: white;
            border-radius: 10px;
            padding: 2rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--dark-blue);
        }
        
        input, select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }
        
        .trips-container {
            margin-top: 2rem;
        }
        
        .trip-item {
            background-color: var(--light-blue);
            padding: 1rem;
            border-radius: 5px;
            margin-bottom: 1rem;
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            align-items: center;
        }
        
        .trip-selections {
            margin: 2rem 0;
        }
        
        .trip-selection {
            background-color: white;
            padding: 1rem;
            border-radius: 5px;
            margin-bottom: 1.5rem;
            position: relative;
            border: 1px solid #ddd;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .trip-selection .remove-trip {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background-color: #f44336;
            color: white;
            border: none;
            padding: 0.25rem 0.5rem;
            border-radius: 3px;
            cursor: pointer;
        }
        
        .trip-display {
            font-size: 1.05rem;
            color: var(--dark-blue);
        }
        
        .trip-fields {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .trip-field {
            flex: 1;
            min-width: 200px;
        }
        
        button {
            background-color: var(--ocean-blue);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 5px;
            font-size: 1rem;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: var(--dark-blue);
        }
        
        .submit-btn {
            background-color: var(--submit-green);
            font-size: 1.1rem;
            padding: 1rem 2rem;
            margin-top: 1rem;
        }
        
        .submit-btn:hover {
            background-color: #2a8943;
        }
        
        .add-trip-btn {
            margin-top: 1rem;
        }
        
        #confirmation-message {
            display: none;
            background-color: #d4edda;
            color: #155724;
            padding: 1rem;
            border-radius: 5px;
            margin-top: 2rem;
            text-align: center;
        }
        
        .special-requests {
            margin-top: 3rem;
            padding: 1.5rem;
            background-color: var(--light-blue);
            border-radius: 10px;
            text-align: center;
        }
        
        .date-interest-count {
            margin-left: 0.5rem;
            font-size: 0.9rem;
            font-weight: normal;
        }
        
        footer {
            text-align: center;
            padding: 2rem;
            margin-top: 3rem;
            background-color: var(--dark-blue);
            color: white;
        }
        
        @media (max-width: 768px) {
            .trip-option {
                width: 100%;
                margin: 1rem 0;
            }
            
            .trip-fields {
                flex-direction: column;
                gap: 1rem;
            }
            
            .trip-field {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>Pelagic Bird Watching Trips</h1>
        <p class="hero-text">Experience the thrill of observing pelagic birds in their natural habitat off the coast of Mangaluru, Karnataka, India</p>
    </header>
    
    <div class="container">
        <section>
            <h2>Choose Your Weekend Adventure</h2>
            <p>Select your preferred weekend dates for your bird watching trips. We offer trips on weekends (Saturday and Sunday) only, with weekday trips available upon special request for groups.</p>
        </section>
        
        <section>
            <h2>Trip Options</h2>
            <div class="trip-options">
                <div class="trip-option">
                    <h3>Half Day</h3>
                    <p><strong>Time:</strong> 6 AM to 1 PM</p>
                    <p><strong>Duration:</strong> 7 hours</p>
                    <p>Perfect for beginners or those with limited time. Experience the morning hours when birds are most active.</p>
                </div>
                
                <div class="trip-option">
                    <h3>Full Day</h3>
                    <p><strong>Time:</strong> 6 AM to 6 PM</p>
                    <p><strong>Duration:</strong> 12 hours</p>
                    <p>For enthusiasts who want to maximize their bird watching experience in a single day.</p>
                </div>
                
                <div class="trip-option">
                    <h3>Overnight</h3>
                    <p><strong>Time:</strong> 6 AM Saturday to 6 PM Sunday</p>
                    <p><strong>Duration:</strong> 36 hours</p>
                    <p>The ultimate experience! Observe nocturnal species and enjoy two full days of bird watching.</p>
                </div>
            </div>
        </section>
        
        <section class="form-section">
            <h2>Express Your Interest</h2>
            <p>Fill out the form below to show your interest in participating. Trips require a minimum of 12 participants to be confirmed.</p>
            
            <form id="interest-form">
                <div class="form-group">
                    <label for="name">Name*</label>
                    <input type="text" id="name" name="name" required>
                </div>
                
                <div class="form-group">
                    <label for="email">Email*</label>
                    <input type="email" id="email" name="email" required>
                </div>
                
                <div class="form-group">
                    <label for="phone">Contact Number*</label>
                    <input type="tel" id="phone" name="phone" required>
                </div>
                
                <div class="form-group">
                    <label for="experience">Experience Level*</label>
                    <select id="experience" name="experience" required>
                        <option value="">-- Select Experience Level --</option>
                        <option value="beginner">Beginner</option>
                        <option value="intermediate">Intermediate</option>
                        <option value="expert">Expert</option>
                    </select>
                </div>
                
                <h3>Trip Selections</h3>
                <div id="trip-selections"></div>
                
                <button type="button" id="add-trip-btn" class="add-trip-btn">+ Add Trip</button>
                
                <button type="submit" class="submit-btn">Submit</button>
            </form>
            
            <div id="confirmation-message">
                Thank you for showing interest! We will contact you once the trip is confirmed.
            </div>
        </section>
        
        <section class="special-requests">
            <h3>Special Requests</h3>
            <p>For special requests, such as weekday trips for groups, please contact us at <strong>info@pelagicbirdwatching.com</strong></p>
        </section>
    </div>
    
    <footer>
        <p>&copy; 2025 Pelagic Bird Watching - Mangaluru | All Rights Reserved</p>
    </footer>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Trip selections container
            const tripSelectionsContainer = document.getElementById('trip-selections');
            const addTripBtn = document.getElementById('add-trip-btn');
            const form = document.getElementById('interest-form');
            const confirmationMessage = document.getElementById('confirmation-message');
            
            // Track trip selections
            let tripSelections = [];
            
            // Trip interest counts (simulated data)
            const tripInterestCounts = {};
            
            // Generate random interest counts for the next 3 months of weekends
            const today = new Date();
            for (let i = 0; i < 90; i++) {
                const date = new Date(today);
                date.setDate(today.getDate() + i);
                
                // Only add counts for weekends
                if (date.getDay() === 0 || date.getDay() === 6) {
                    const dateStr = date.toISOString().split('T')[0];
                    // Random number between 0 and 11
                    tripInterestCounts[dateStr] = Math.floor(Math.random() * 11);
                }
            }
            
            // Generate a unique ID for each trip selection
            function generateTripId() {
                return 'trip_' + Date.now() + '_' + Math.floor(Math.random() * 1000);
            }
            
            // Check if a date is already selected in another trip
            function isDateConflict(tripType, selectedDate, tripId) {
                const dateObj = new Date(selectedDate);
                const day = dateObj.getDay(); // 0 is Sunday, 6 is Saturday
                
                for (const trip of tripSelections) {
                    if (trip.id === tripId) continue; // Skip current trip being edited
                    
                    const tripDateObj = new Date(trip.date);
                    
                    // If this is an overnight trip starting on Saturday
                    if (tripType === 'overnight' && day === 6) {
                        const sunday = new Date(dateObj);
                        sunday.setDate(dateObj.getDate() + 1);
                        
                        // Check if any existing trip falls on this Saturday or the following Sunday
                        if (isSameDate(tripDateObj, dateObj) || isSameDate(tripDateObj, sunday)) {
                            return true;
                        }
                    }
                    // If this is an overnight trip that another user has selected
                    else if (trip.type === 'overnight') {
                        const tripSunday = new Date(tripDateObj);
                        tripSunday.setDate(tripDateObj.getDate() + 1);
                        
                        // Check if our selected date falls on the overnight trip's Saturday or Sunday
                        if (isSameDate(dateObj, tripDateObj) || isSameDate(dateObj, tripSunday)) {
                            return true;
                        }
                    }
                    // For Half day or Full day, check if same day is already selected with same trip type
                    else if (isSameDate(tripDateObj, dateObj)) {
                        return true;
                    }
                }
                
                return false;
            }
            
            // Check if two dates are the same (ignoring time)
            function isSameDate(date1, date2) {
                return date1.getFullYear() === date2.getFullYear() &&
                       date1.getMonth() === date2.getMonth() &&
                       date1.getDate() === date2.getDate();
            }
            
            // Format date for display
            function formatDate(dateString) {
                const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
                return new Date(dateString).toLocaleDateString(undefined, options);
            }
            
            // Validate trip data before adding
            function validateTripData(tripType, tripDate, tripId) {
                if (!tripType) {
                    alert('Please select a trip type.');
                    return false;
                }
                
                if (!tripDate) {
                    alert('Please select a date for your trip.');
                    return false;
                }
                
                const dateObj = new Date(tripDate);
                const day = dateObj.getDay();
                
                // For overnight trips, only allow selection of Saturdays
                if (tripType === 'overnight' && day !== 6) {
                    alert('Overnight trips must start on a Saturday.');
                    return false;
                }
                
                // Check for date conflicts
                if (isDateConflict(tripType, tripDate, tripId)) {
                    alert('This date conflicts with another trip you have selected. Please choose a different date.');
                    return false;
                }
                
                return true;
            }
            
            // Format date in a user-friendly way
            function formatDisplayDate(dateString) {
                const options = { weekday: 'long', month: 'long', day: 'numeric', year: 'numeric' };
                return new Date(dateString).toLocaleDateString(undefined, options);
            }

            // Update the interest count display
            function updateInterestCount(tripId) {
                const dateInput = document.getElementById(`${tripId}_date`);
                const interestCountElement = document.getElementById(`${tripId}_interest_count`);
                
                if (!dateInput.value) {
                    interestCountElement.textContent = '';
                    return;
                }
                
                const dateStr = dateInput.value.split(' ')[0]; // Get just the date part
                const count = tripInterestCounts[dateStr] || 0;
                interestCountElement.textContent = `(${count}/12 spots filled)`;
                
                // Change color based on spots filled
                if (count >= 10) {
                    interestCountElement.style.color = '#34a853'; // Green for almost full
                } else if (count >= 6) {
                    interestCountElement.style.color = '#fbbc05'; // Yellow for halfway full
                } else {
                    interestCountElement.style.color = '#ea4335'; // Red for low interest
                }
            }
            
            // Update trip display text
            function updateTripDisplay(tripId) {
                const tripType = document.getElementById(`${tripId}_type`).value;
                const tripDate = document.getElementById(`${tripId}_date`).value;
                const displayDiv = document.getElementById(`${tripId}_display`);
                
                if (!tripType || !tripDate) {
                    displayDiv.style.display = 'none';
                    return;
                }
                
                displayDiv.style.display = 'block';
                
                if (tripType === 'overnight') {
                    // For overnight, show start and end date
                    const startDate = new Date(tripDate);
                    const endDate = new Date(tripDate);
                    endDate.setDate(endDate.getDate() + 1);
                    
                    displayDiv.innerHTML = `<strong>Selected:</strong> Overnight trip: ${formatDisplayDate(startDate)} to ${formatDisplayDate(endDate)}`;
                } else if (tripType === 'half-day') {
                    displayDiv.innerHTML = `<strong>Selected:</strong> Half Day on ${formatDisplayDate(tripDate)}`;
                } else if (tripType === 'full-day') {
                    displayDiv.innerHTML = `<strong>Selected:</strong> Full Day on ${formatDisplayDate(tripDate)}`;
                }
            }
            
            // Create a new trip selection element
            function createTripSelection() {
                const tripId = generateTripId();
                
                const tripDiv = document.createElement('div');
                tripDiv.className = 'trip-selection';
                tripDiv.id = tripId;
                
                tripDiv.innerHTML = `
                    <button type="button" class="remove-trip">Remove</button>
                    <div class="trip-fields">
                        <div class="trip-field">
                            <label for="${tripId}_type">Trip Type*</label>
                            <select id="${tripId}_type" name="${tripId}_type" required>
                                <option value="">-- Select Trip Type --</option>
                                <option value="half-day">Half Day (6 AM - 1 PM)</option>
                                <option value="full-day">Full Day (6 AM - 6 PM)</option>
                                <option value="overnight">Overnight (Sat 6 AM - Sun 6 PM)</option>
                            </select>
                        </div>
                        <div class="trip-field">
                            <label for="${tripId}_date">Date* <span id="${tripId}_interest_count" class="date-interest-count"></span></label>
                            <input type="text" id="${tripId}_date" name="${tripId}_date" class="date-picker" required>
                        </div>
                    </div>
                    <div class="trip-display" id="${tripId}_display" style="display: none; margin-top: 15px; padding: 10px; background-color: #e8f0fe; border-radius: 5px;"></div>
                `;
                
                tripSelectionsContainer.appendChild(tripDiv);
                
                // Initialize date picker for this trip
                const datePicker = flatpickr(`#${tripId}_date`, {
                    minDate: "today",
                    disable: [
                        function(date) {
                            // Disable all days except weekends
                            return (date.getDay() !== 0 && date.getDay() !== 6);
                        }
                    ],
                    onChange: function(selectedDates, dateStr) {
                        // Update interest count whenever date changes
                        updateInterestCount(tripId);
                    }
                });
                
                // Add event listener to trip type dropdown
                const tripTypeSelect = document.getElementById(`${tripId}_type`);
                tripTypeSelect.addEventListener('change', function() {
                    const tripType = this.value;
                    
                    // Reconfigure date picker based on trip type
                    if (tripType === 'overnight') {
                        // For overnight trips, only allow Saturdays
                        datePicker.set('disable', [
                            function(date) {
                                // Only enable Saturdays
                                return date.getDay() !== 6;
                            }
                        ]);
                    } else {
                        // For half day and full day, allow both Saturday and Sunday
                        datePicker.set('disable', [
                            function(date) {
                                // Only enable weekends
                                return (date.getDay() !== 0 && date.getDay() !== 6);
                            }
                        ]);
                    }
                    
                    // Clear the date when trip type changes
                    datePicker.clear();
                    
                    // Update the display
                    updateTripDisplay(tripId);
                });
                
                // Add event listener to date picker
                document.getElementById(`${tripId}_date`).addEventListener('change', function() {
                    updateTripDisplay(tripId);
                    updateInterestCount(tripId);
                });
                
                // Add event listener to remove button
                const removeBtn = tripDiv.querySelector('.remove-trip');
                removeBtn.addEventListener('click', function() {
                    // Find the index of this trip in our array
                    const index = tripSelections.findIndex(trip => trip.id === tripId);
                    if (index !== -1) {
                        tripSelections.splice(index, 1);
                    }
                    
                    // Remove the trip selection from the DOM
                    tripDiv.remove();
                });
                
                // Initialize empty interest count
                updateInterestCount(tripId);
                
                return { tripDiv, tripId };
            }
            
            // Add trip button click handler
            addTripBtn.addEventListener('click', function() {
                const { tripId } = createTripSelection();
                
                // Add a placeholder for this trip in our selections array
                tripSelections.push({
                    id: tripId,
                    type: '',
                    date: ''
                });
                
                // Update display (will be hidden initially)
                updateTripDisplay(tripId);
            });
            
            // Form submission handler
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const name = document.getElementById('name').value;
                const email = document.getElementById('email').value;
                const phone = document.getElementById('phone').value;
                const experience = document.getElementById('experience').value;
                
                // Basic validation
                if (!name || !email || !phone || !experience) {
                    alert('Please fill in all required fields.');
                    return;
                }
                
                // Validate trip selections
                const tripDivs = document.querySelectorAll('.trip-selection');
                if (tripDivs.length === 0) {
                    alert('Please add at least one trip selection.');
                    return;
                }
                
                // Update our trip selections array with the latest values
                let tripSelectionsValid = true;
                tripSelections = [];
                
                tripDivs.forEach(tripDiv => {
                    const tripId = tripDiv.id;
                    const tripType = document.getElementById(`${tripId}_type`).value;
                    const tripDate = document.getElementById(`${tripId}_date`).value;
                    
                    if (!validateTripData(tripType, tripDate, tripId)) {
                        tripSelectionsValid = false;
                        return;
                    }
                    
                    tripSelections.push({
                        id: tripId,
                        type: tripType,
                        date: tripDate
                    });
                });
                
                if (!tripSelectionsValid) {
                    return;
                }
                
                // Simulate form submission
                console.log('Form Data:', {
                    name,
                    email,
                    phone,
                    experience,
                    trips: tripSelections
                });
                
                // Show confirmation message
                form.style.display = 'none';
                confirmationMessage.style.display = 'block';
                
                // Scroll to confirmation message
                confirmationMessage.scrollIntoView({ behavior: 'smooth' });
            });
            
            // Add initial trip selection
            createTripSelection();
        });
    </script>
</body>
</html>
